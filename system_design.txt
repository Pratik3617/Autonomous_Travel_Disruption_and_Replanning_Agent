## Autonomous Travel Disruption & Re-Planning Agent

---

## 1ï¸âƒ£ Problem Restatement

**Goal**
Build an **agentic system** that:

* Predicts **flight disruptions (delay/cancellation)**
* Explains *why* disruption is likely
* Automatically **re-plans travel routes**
* Optimizes based on **user preferences**
* Works **without relying on proprietary real-time APIs**

This is **decision automation**, not just prediction.

---

## 2ï¸âƒ£ High-Level Architecture (Birdâ€™s-Eye View)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   User App  â”‚
â”‚ (Web/Mobile)â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚ REST / WebSocket
â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          FastAPI Gateway        â”‚
â”‚  (Auth, validation, orchestration)â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      MCP Agent Orchestrator     â”‚
â”‚ (controls agent execution flow) â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Predictive Agentsâ”‚   â”‚ Planning Agents     â”‚
â”‚ (delay, causes)  â”‚   â”‚ (routes, tradeoffs) â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                          â”‚
â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Data Layer     â”‚   â”‚ External Knowledge  â”‚
â”‚ (SQL + Mongo)   â”‚   â”‚ (maps, weather, etc)â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 3ï¸âƒ£ Core Design Principle (Why This Is Agentic)

We **separate concerns**:

| Concern     | Why separate                |
| ----------- | --------------------------- |
| Prediction  | ML + statistics             |
| Explanation | Human-readable reasoning    |
| Planning    | Graph search + optimization |
| Preferences | Stateful, personal          |
| Monitoring  | Continuous                  |

Each concern = **one agent**.

No god-model. No monolith.

---

## 4ï¸âƒ£ Agent Breakdown (Very Important)

### ğŸ§  1. Trip Memory Agent

**Responsibility**

* Stores itinerary
* Stores user preferences
* Maintains state across time

**Examples**

* Budget
* Max acceptable delay
* Avoid overnight stays

**Storage**

* MongoDB (document-based, evolving state)

---

### ğŸ§  2. Disruption Prediction Agent

**Responsibility**

* Predict probability of delay or cancellation
* Uses historical data (our Kaggle datasets)

**Inputs**

* Flight number
* Origin/destination
* Date, time
* Airline

**Outputs**

```json
{
  "delay_probability": 0.42,
  "cancellation_probability": 0.08
}
```

**Tech**

* Trained ML model
* SQL for feature retrieval

---

### ğŸ§  3. Delay Cause Explanation Agent

**Responsibility**

* Explains *why* disruption is likely
* Uses BTS delay-cause dataset

**Output Example**

```json
{
  "primary_causes": ["weather", "carrier_delay"],
  "explanation": "This route experiences winter weather disruptions 38% of the time."
}
```

This agent is **crucial for trust**.

---

### ğŸ§  4. Disruption Detection Agent

**Responsibility**

* Decides when action is required
* Converts prediction â†’ decision

**Logic**

```text
IF delay_probability > threshold
OR cancellation_probability > threshold
â†’ trigger replanning
```

This agent is **policy-driven**, not ML-heavy.

---

### ğŸ§  5. Route Planning Agent

**Responsibility**

* Generate alternative routes
* Multimodal (flight + train + bus)

**Inputs**

* Origin
* Destination
* Constraints

**Outputs**

```json
[
  { "route": ["DEL â†’ FRA â†’ BER"], "duration": 14h, "cost": 820 },
  { "route": ["DEL â†’ MUC â†’ BER"], "duration": 15h, "cost": 760 }
]
```

**Data**

* OpenFlights
* GTFS (future extension)

---

### ğŸ§  6. Constraint & Preference Agent

**Responsibility**

* Filter routes based on:

  * Budget
  * Time
  * Overnight stays
  * User dislikes

This agent makes it **personal**, not generic.

---

### ğŸ§  7. Decision Agent

**Responsibility**

* Rank routes
* Select best option
* Provide rationale

**Output**

```json
{
  "selected_route": "DEL â†’ MUC â†’ BER",
  "reason": "Minimizes cost while keeping arrival delay under 2 hours"
}
```

This is where **agent reasoning shines**.

---

### ğŸ§  8. Notification Agent

**Responsibility**

* Communicate outcome clearly
* Human-friendly explanation
* No raw probabilities dumped

---

## 5ï¸âƒ£ Data Layer Design

### ğŸ—„ SQL (Structured, Analytical)

Used for:

* Flight history
* Delay statistics
* Time-series queries

**Examples**

* PostgreSQL
* Indexed by route, airline, date

---

### ğŸ“¦ MongoDB (State & Memory)

Used for:

* Trips
* User preferences
* Agent intermediate outputs

This separation is **industry-correct**.

---

## 6ï¸âƒ£ FastAPI â€“ Service Boundaries

### Core APIs

```http
POST /trip/create
POST /trip/monitor
GET  /trip/status
POST /trip/replan
```

FastAPI:

* Validates input
* Calls MCP orchestrator
* Returns final decision

Agents never talk directly to users.

---

## 7ï¸âƒ£ MCP Orchestration Flow (Step-by-Step)

```
Trip Created
   â†“
Trip Memory Agent stores state
   â†“
Disruption Prediction Agent runs
   â†“
Explanation Agent enriches output
   â†“
Disruption Detection Agent decides
   â†“ (if triggered)
Route Planning Agent generates options
   â†“
Constraint Agent filters
   â†“
Decision Agent selects best
   â†“
Notification Agent responds
```

This flow is **clean, testable, extensible**.

---

## 8ï¸âƒ£ Failure & Edge-Case Handling

| Scenario         | Handling                         |
| ---------------- | -------------------------------- |
| Missing data     | Fallback to route-level averages |
| Low confidence   | Ask user confirmation            |
| Too many options | Limit + explain                  |
| No valid routes  | Suggest wait / monitor           |

This matters a LOT in interviews.

---

## 9ï¸âƒ£ Why This Design Is Strong

* âœ… Truly agentic (not forced)
* âœ… Clear separation of responsibilities
* âœ… Works offline / with replayed data
* âœ… Plug-and-play data sources
* âœ… Easy to extend (trains, hotels later)

---

## 10ï¸âƒ£ What Comes Next (Logical Order)

Now that **system design is locked**, the correct next steps are:

1ï¸âƒ£ **Database schema design (SQL + Mongo)**
2ï¸âƒ£ **Agent interface contracts (inputs/outputs)**
3ï¸âƒ£ **Data ingestion & ETL plan**
4ï¸âƒ£ **Modeling strategy**



